#include <SmearingTool.h>

// couldn't be inside class due to root feacher during TF1 creation:
Double_t DoubleGauss(Double_t*, Double_t* );

   const float SmearingTool::PTbin[14]={25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 80, 100, 150, 300};
   const float SmearingTool::ETAbin[9]={-2.1, -1.6, -1.2, -0.8, 0, 0.8, 1.2, 1.6, 2.1};

   ////// Smearing parametrization for single muon:
   const float SmearingTool::mean[104]={
                   -0.000818792, -0.0019813, -0.00229078, -0.00232072, -0.00238515, -0.00266465, -0.00346386, -0.00350292, -0.00339193, -0.00429039, -0.0047417, -0.00796324, -0.0112071, 
                   0.000185951, -0.000911495, -0.000964056, -0.000909267, -0.000878829, -0.00107763, -0.000960349, -0.00136659, -0.00165224, -0.00103517, -0.00110369, -0.000777983, -0.00713651, 
                   0.000641385, 4.31041e-06, 1.45473e-05, -3.03754e-05, -5.26621e-05, -1.27983e-05, -4.00618e-05, -0.000343613, -0.000116529, -0.000110424, -0.000258518, 0.000304597, 0.000506048, 
                   0.00030946, 0.000195393, 0.000182324, 0.000152074, 0.00013299, 0.000102254, 0.000175597, 0.000161456, 0.00010004, 0.000251218, 0.000190075, 0.000120758, 0.000319338, 
                   0.000337308, 0.000104514, 9.46657e-05, 6.4098e-05, 3.05061e-05, -3.43646e-05, 2.69435e-05, 0.000120729, -0.000192523, 4.1645e-05, 0.000127049, -0.000851627, 6.20618e-05, 
                   0.00043823, -0.000170396, -0.000211422, -0.000264694, -0.000368671, -0.000391881, -0.000488537, -0.000780863, -0.000284322, -0.000945112, -0.000633755, -0.00145394, -0.000666707, 
                   -2.68591e-05, -0.000938284, -0.000983442, -0.000981883, -0.00120897, -0.00130699, -0.00146165, -0.00163547, -0.00152747, -0.00101184, -0.00107564, -0.0018403, -0.000211163, 
                   -0.000771689, -0.00186575, -0.00206869, -0.00223194, -0.00236067, -0.00250446, -0.00324465, -0.0034507, -0.00300726, -0.003286, -0.00305733, -0.00590464, -0.0106659};
   const float SmearingTool::sig1[104]={
                   0.0177752, 0.0191454, 0.0196334, 0.0201871, 0.0202325, 0.0207184, 0.0203775, 0.0223092, 0.0223682, 0.0288585, 0.0313501, 0.0358772, 0.0539717, 
                   0.0171232, 0.0177832, 0.0181006, 0.0186912, 0.0189444, 0.0195711, 0.0200708, 0.0206138, 0.0199512, 0.0239999, 0.0257488, 0.0296709, 0.0363558, 
                   0.0142851, 0.0147746, 0.015031, 0.0154078, 0.0159077, 0.0161369, 0.016946, 0.016524, 0.0177892, 0.0189582, 0.0190516, 0.0284988, 0.0343719, 
                   0.00983677, 0.0102821, 0.0106798, 0.0111613, 0.011554, 0.0118674, 0.0124424, 0.0126566, 0.0133676, 0.0137648, 0.0155647, 0.0179477, 0.0308084, 
                   0.00981514, 0.0102786, 0.0106608, 0.0111348, 0.0115009, 0.0119379, 0.0123747, 0.0129489, 0.0133528, 0.0140727, 0.0153449, 0.0180345, 0.0307005, 
                   0.0140582, 0.0149111, 0.0151409, 0.0156467, 0.0158809, 0.0164171, 0.0167062, 0.0175171, 0.0181975, 0.0193831, 0.0200302, 0.0283623, 0.0349969, 
                   0.016801, 0.0176604, 0.0179746, 0.0186716, 0.0189601, 0.0194079, 0.0199112, 0.0202101, 0.0191584, 0.0242458, 0.0253274, 0.0288614, 0.0368529, 
                   0.0179927, 0.0192443, 0.0191465, 0.0199735, 0.020404, 0.020727, 0.0204815, 0.0208858, 0.0219712, 0.0286602, 0.0318052, 0.0376063, 0.0527534};
   const float SmearingTool::sig2[104]={
                   0.029671, 0.0322832, 0.0328749, 0.0337977, 0.032404, 0.0338992, 0.0326978, 0.0368495, 0.0347744, 3, 3, 3, 3, 
                   0.0321858, 0.0334466, 0.0343158, 0.0354341, 0.0352734, 0.0383318, 0.0409971, 0.0419815, 0.0376102, 3, 3, 3, 3, 
                   0.0288471, 0.0294923, 0.0301581, 0.0303312, 0.0319001, 0.0321091, 0.0339017, 0.0305829, 0.034222, 0.0378543, 0.0360078, 3, 3, 
                   0.0233059, 0.0258993, 0.0271415, 0.029254, 0.0302322, 0.0306788, 0.0328005, 0.0320382, 0.0345358, 0.0352715, 0.0412346, 0.0369842, 3, 
                   0.0236622, 0.0253004, 0.0262723, 0.0278398, 0.0286041, 0.0308088, 0.0310601, 0.0325008, 0.0332358, 0.0376627, 0.0377564, 0.0388637, 3, 
                   0.0268536, 0.0301432, 0.0302067, 0.0313623, 0.0313669, 0.0322928, 0.0328092, 0.0332305, 0.0391622, 0.0432612, 0.0368664, 3, 3, 
                   0.031181, 0.0315536, 0.0338863, 0.0353785, 0.0367883, 0.03814, 0.0399333, 0.0371496, 0.0336763, 3, 3, 3, 3, 
                   0.0309431, 0.0333797, 0.0318975, 0.0340276, 0.0341472, 0.0342788, 0.0325792, 0.0350637, 0.0370796, 3, 3, 3, 3};
   const float SmearingTool::Asig2[104]={
                   0.168895, 0.139264, 0.153302, 0.15845, 0.239869, 0.243992, 0.4, 0.20928, 0.4, 0, 0, 0, 0, 
                   0.0683224, 0.0762051, 0.0754545, 0.0696074, 0.0807053, 0.0597564, 0.052074, 0.0425726, 0.0905311, 0, 0, 0, 0, 
                   0.058579, 0.0644551, 0.0736152, 0.0827931, 0.077174, 0.0889331, 0.0751085, 0.139083, 0.0966058, 0.0774382, 0.196541, 0, 0, 
                   0.0419521, 0.0367217, 0.038295, 0.0351322, 0.0356556, 0.0411181, 0.0384931, 0.0481274, 0.0401447, 0.0509164, 0.0427791, 0.117119, 0, 
                   0.0399389, 0.0390516, 0.0428331, 0.0400477, 0.0425525, 0.0391955, 0.044414, 0.0434457, 0.0469206, 0.0403208, 0.056263, 0.103559, 0, 
                   0.0856816, 0.0627157, 0.0745469, 0.0757397, 0.0881527, 0.0855171, 0.100783, 0.107464, 0.0696318, 0.0530725, 0.128233, 0, 0, 
                   0.0784808, 0.0916364, 0.0757539, 0.0644224, 0.0627956, 0.0630402, 0.0570831, 0.0898973, 0.161153, 0, 0, 0, 0, 
                   0.133783, 0.123983, 0.213415, 0.173602, 0.192858, 0.244819, 0.4, 0.4, 0.36156, 0, 0, 0, 0};

   const float SmearingTool::ERRmean[104]={
                   8.33354e-05, 7.03825e-05, 6.31206e-05, 5.79435e-05, 7.20963e-05, 0.000123382, 0.000190147, 0.000270204, 0.000370934, 0.000383728, 0.000530475, 0.000926827, 0.0037459, 
                   8.07931e-05, 6.71589e-05, 5.74401e-05, 4.96269e-05, 6.06599e-05, 0.000101072, 0.000155553, 0.000212343, 0.000282156, 0.000293114, 0.000393586, 0.000668542, 0.00169525, 
                   6.51663e-05, 5.29555e-05, 4.40451e-05, 3.83963e-05, 4.85698e-05, 8.1316e-05, 0.000124023, 0.000171259, 0.000233466, 0.000242945, 0.000331816, 0.000581646, 0.00144207, 
                   2.91961e-05, 2.25655e-05, 1.93253e-05, 1.82888e-05, 2.36588e-05, 3.96345e-05, 6.05462e-05, 8.51579e-05, 0.000115098, 0.000118492, 0.000163889, 0.000285608, 0.00081396, 
                   2.92741e-05, 2.2621e-05, 1.94098e-05, 1.83691e-05, 2.37712e-05, 3.98419e-05, 6.08789e-05, 8.62104e-05, 0.000116099, 0.000119386, 0.000165634, 0.00029167, 0.000811765, 
                   6.54598e-05, 5.35833e-05, 4.43798e-05, 3.89726e-05, 4.91868e-05, 8.22488e-05, 0.000125213, 0.000178796, 0.000237614, 0.000243539, 0.000330551, 0.000580473, 0.00146822, 
                   7.99994e-05, 6.74418e-05, 5.72562e-05, 4.96624e-05, 6.0262e-05, 0.000102042, 0.000153906, 0.000221946, 0.000283741, 0.000298433, 0.000391906, 0.000648429, 0.00173748, 
                   8.18651e-05, 7.0267e-05, 6.26661e-05, 5.76952e-05, 7.16594e-05, 0.000123081, 0.000187954, 0.00027471, 0.000370839, 0.000376691, 0.000537859, 0.000984044, 0.0037244};
   const float SmearingTool::ERRsig1[104]={
                   0.000233677, 0.000182904, 0.000178526, 0.000169603, 0.000250631, 0.000434266, 0.000301683, 0.000821772, 0.000616361, 0.000276933, 0.000390286, 0.000719121, 0.00380114, 
                   0.000145138, 0.000126441, 0.000107146, 9.1743e-05, 0.000119558, 0.000182352, 0.000256662, 0.000347391, 0.000555951, 0.000207746, 0.000279938, 0.000484514, 0.00132269, 
                   0.000103167, 8.71732e-05, 7.46213e-05, 6.75746e-05, 8.32147e-05, 0.000142113, 0.000216996, 0.000379173, 0.000464627, 0.000466622, 0.000862328, 0.000418403, 0.0010939, 
                   3.76907e-05, 2.72125e-05, 2.30914e-05, 2.13158e-05, 2.7761e-05, 4.73249e-05, 7.12709e-05, 0.000104029, 0.000133902, 0.000149123, 0.000211258, 0.000517213, 0.000595088, 
                   3.68488e-05, 2.79408e-05, 2.39125e-05, 2.22916e-05, 2.91257e-05, 4.71532e-05, 7.59638e-05, 0.000109156, 0.000149854, 0.000146322, 0.000233364, 0.000530254, 0.00059295, 
                   0.000121894, 8.58679e-05, 7.36547e-05, 6.70588e-05, 8.75305e-05, 0.000146533, 0.000243132, 0.000381928, 0.000393455, 0.000403235, 0.000746773, 0.00041729, 0.00112242, 
                   0.000148673, 0.000139125, 0.000108402, 9.24923e-05, 0.000107334, 0.000181314, 0.000257895, 0.000542186, 0.000716611, 0.000211591, 0.000278445, 0.000467528, 0.00136181, 
                   0.000204509, 0.000174826, 0.000197686, 0.000169786, 0.000228195, 0.000457978, 0.000296608, 0.000428048, 0.001539, 0.000271401, 0.000397031, 0.000780704, 0.00371774};
   const float SmearingTool::ERRsig2[104]={
                   0.000759346, 0.000760303, 0.000694373, 0.00066275, 0.000672372, 0.00118542, 0.000315595, 0.00295231, 0.000680734, 0, 0, 0, 0, 
                   0.00101993, 0.000840847, 0.000742278, 0.000707513, 0.0008184, 0.00174784, 0.00305928, 0.00510847, 0.00383722, 0, 0, 0, 0, 
                   0.000724238, 0.000574605, 0.000447777, 0.000374334, 0.000505002, 0.000782713, 0.00143596, 0.00141009, 0.00255302, 0.00343586, 0.0027913, 0, 0, 
                   0.000310744, 0.000249122, 0.000208072, 0.000209069, 0.000273681, 0.000427266, 0.00070665, 0.000866578, 0.00137118, 0.0012912, 0.00252251, 0.00266903, 0, 
                   0.00031506, 0.000244342, 0.000197758, 0.000196215, 0.00024828, 0.000442394, 0.000650008, 0.000976549, 0.00129234, 0.00160668, 0.00202598, 0.00316475, 0, 
                   0.000618516, 0.000587573, 0.000444018, 0.000405844, 0.000473276, 0.000831103, 0.00121332, 0.00185554, 0.0032439, 0.00489075, 0.0037111, 0, 0, 
                   0.000912707, 0.000776768, 0.000736043, 0.000755854, 0.000937691, 0.001659, 0.00275913, 0.00360847, 0.00267086, 0, 0, 0, 0, 
                   0.000823481, 0.000811989, 0.000557094, 0.000608117, 0.000756204, 0.00122827, 0.000313738, 0.000453955, 0.00323165, 0, 0, 0, 0};
   const float SmearingTool::ERRAsig2[104]={
                   0.0284516, 0.0201134, 0.0201654, 0.0191493, 0.0351826, 0.0566419, 0.0430692, 0.0971229, 0.246198, 0, 0, 0, 0, 
                   0.0110443, 0.00962572, 0.00798794, 0.00666528, 0.00925401, 0.0118993, 0.0151623, 0.0198934, 0.0423711, 0, 0, 0, 0, 
                   0.00711465, 0.00613847, 0.00527947, 0.00504413, 0.00577652, 0.0102972, 0.0146644, 0.0349952, 0.0348838, 0.0304627, 0.0760491, 0, 0, 
                   0.00230859, 0.00136039, 0.0011097, 0.000912379, 0.00116576, 0.00206998, 0.00288228, 0.00469381, 0.00544724, 0.00639708, 0.00794497, 0.0356757, 0, 
                   0.00215186, 0.00148781, 0.00125663, 0.00107857, 0.00140921, 0.00203476, 0.00345189, 0.00479101, 0.00667663, 0.00551823, 0.0104662, 0.0329359, 0, 
                   0.0105024, 0.0058254, 0.00528988, 0.00467917, 0.00646155, 0.0106083, 0.0180935, 0.030415, 0.0222038, 0.0205891, 0.062878, 0, 0, 
                   0.0120867, 0.0125287, 0.00819059, 0.00663491, 0.0072627, 0.0119259, 0.0160222, 0.0429751, 0.0713013, 0, 0, 0, 0, 
                   0.0216205, 0.0173656, 0.0246417, 0.0187405, 0.0267706, 0.0574634, 0.254746, 0.248112, 0.346767, 0, 0, 0, 0};

   const float SmearingTool::ResRMS[104]={
                   0.0209127, 0.0221394, 0.0228357, 0.0235224, 0.0240815, 0.0249652, 0.0256898, 0.0264077, 0.027445, 0.0287356, 0.0310769, 0.0349522, 0.0453881, 
                   0.0193522, 0.0203044, 0.0206908, 0.0211645, 0.0216076, 0.0220031, 0.0225299, 0.0226621, 0.0230619, 0.0239896, 0.0257269, 0.0295392, 0.0353182, 
                   0.0164101, 0.0170644, 0.0176643, 0.0181908, 0.0187731, 0.0193059, 0.0198682, 0.0201381, 0.02105, 0.0221054, 0.0244419, 0.0284074, 0.0337534, 
                   0.0116826, 0.0123663, 0.0129814, 0.0136062, 0.0140945, 0.0146954, 0.0153848, 0.0158516, 0.0164187, 0.0174446, 0.0192567, 0.0225733, 0.030545, 
                   0.0116859, 0.0123283, 0.0129629, 0.0135023, 0.0140304, 0.0146544, 0.0152482, 0.0158741, 0.0164735, 0.0175118, 0.0191678, 0.0227925, 0.0304869, 
                   0.0164412, 0.0172578, 0.0177709, 0.0184251, 0.018913, 0.0194144, 0.0201541, 0.0208795, 0.0216825, 0.0224797, 0.0238337, 0.0282843, 0.0343352, 
                   0.0191685, 0.0201218, 0.0205178, 0.0209842, 0.0214078, 0.0219778, 0.0224385, 0.0230915, 0.0229751, 0.0242313, 0.0253065, 0.0287651, 0.0358251, 
                   0.0209565, 0.0222674, 0.0230589, 0.0237256, 0.0242683, 0.0251355, 0.0256593, 0.0270873, 0.0280688, 0.0285507, 0.0315084, 0.0363519, 0.0449574};
   const float SmearingTool::ErrResRMS[104]={
                   6.01481e-05, 5.07286e-05, 4.54102e-05, 4.16131e-05, 5.15987e-05, 8.83027e-05, 0.000135616, 0.000192342, 0.000261702, 0.000269157, 0.000368607, 0.00062079, 0.00182578, 
                   5.86495e-05, 4.88862e-05, 4.18152e-05, 3.60023e-05, 4.39726e-05, 7.31901e-05, 0.000112695, 0.000152934, 0.000204272, 0.000207115, 0.000277841, 0.000468464, 0.00113051, 
                   4.80321e-05, 3.90438e-05, 3.26462e-05, 2.84076e-05, 3.59969e-05, 6.03556e-05, 9.1581e-05, 0.000126204, 0.000171484, 0.000177876, 0.000243761, 0.000408751, 0.00098427, 
                   2.22416e-05, 1.74459e-05, 1.50378e-05, 1.43112e-05, 1.8509e-05, 3.11725e-05, 4.7687e-05, 6.70524e-05, 9.00741e-05, 9.36609e-05, 0.000127924, 0.000214372, 0.000566815, 
                   2.23893e-05, 1.74136e-05, 1.50384e-05, 1.42413e-05, 1.84638e-05, 3.11956e-05, 4.74965e-05, 6.70611e-05, 9.04183e-05, 9.40461e-05, 0.000128559, 0.000220343, 0.000566323, 
                   4.81557e-05, 3.9581e-05, 3.28708e-05, 2.88742e-05, 3.64608e-05, 6.0734e-05, 9.29005e-05, 0.000131471, 0.000176649, 0.000179465, 0.000240071, 0.000408163, 0.00099869, 
                   5.82315e-05, 4.88321e-05, 4.16556e-05, 3.5985e-05, 4.3741e-05, 7.40761e-05, 0.000111677, 0.000159506, 0.000204971, 0.000210827, 0.00027671, 0.000455386, 0.0011611, 
                   5.91817e-05, 5.07235e-05, 4.52113e-05, 4.15825e-05, 5.1477e-05, 8.8103e-05, 0.00013416, 0.000196038, 0.000263166, 0.000264449, 0.000373253, 0.000649349, 0.00186998};

   ////// End smearing parametrization for single muon minus:

   ////// Smearing parametrization for single muon plus:
   const float SmearingTool::meanMuPlus[104]={
                   0.000958364, 6.58645e-05, 0.000116469, 0.000202262, 0.000280931, 0.00033865, 0.000314962, 0.000196931, -0.000261533, 0.000332166, 0.00147352, 0.00298142, 0.000772305, 
                   0.000472903, -0.000303847, -9.23608e-05, -0.000178664, -0.000102098, -0.000416621, 9.72872e-05, 0.000146854, 2.19596e-05, 4.71937e-05, 0.000232767, -0.000832672, 0.000202537, 
                   0.000549283, -0.000141634, -9.04759e-05, -0.000111881, -0.000132521, -0.00030169, -0.000169371, -0.000352888, -0.000154237, -0.000271971, -0.000200835, -0.0005937, -0.00212319, 
                   0.000282221, 6.18014e-05, 6.22721e-05, 3.93612e-05, 7.38602e-05, -3.84183e-05, 7.91031e-05, -2.45327e-05, 0.000210306, -0.000125218, 7.41519e-05, 0.000119155, -0.00235851, 
                   0.000358192, 0.000123629, 0.000127135, 0.000133255, 0.00012799, 0.000103569, 7.50279e-05, 2.05824e-05, 6.63776e-06, 0.00018576, -4.15588e-05, 0.000228972, -0.000151359, 
                   0.000638933, 0.000109273, 5.56563e-05, 5.87105e-05, 3.77613e-05, 0.000119742, 7.03731e-05, 4.17318e-05, -0.000382503, 2.79107e-05, 0.000360732, 0.000632943, 0.000227017, 
                   0.000578093, -0.000126433, -0.000153334, -6.31714e-05, -6.70296e-06, 3.72249e-05, 0.000177869, -0.000235171, 0.000271752, 0.000118884, 0.00065387, 0.000769864, -0.000470076, 
                   0.000679369, -4.12086e-05, -6.49797e-05, 0.000167921, 7.45261e-05, 0.000239426, 0.000180426, 0.000150653, 0.000610777, 0.00102589, 0.000182726, 0.0014743, 0.00519247};
   const float SmearingTool::sig1MuPlus[104]={
                   0.0176644, 0.0191736, 0.0194739, 0.0198559, 0.0206295, 0.0211978, 0.0217628, 0.0232591, 0.0243357, 0.0286464, 0.0312607, 0.037005, 0.0560424, 
                   0.0170532, 0.0180064, 0.018315, 0.0187276, 0.0191394, 0.0195103, 0.0196324, 0.0208123, 0.0213272, 0.0243996, 0.0254192, 0.0288973, 0.0362671, 
                   0.0140635, 0.0147259, 0.0151899, 0.0155566, 0.016111, 0.0163043, 0.016841, 0.0175553, 0.018493, 0.0180527, 0.0210251, 0.028391, 0.0360774, 
                   0.0100274, 0.0104325, 0.0108937, 0.0112858, 0.0117127, 0.0121156, 0.0127336, 0.012986, 0.013505, 0.0140858, 0.0158127, 0.0187541, 0.0307258, 
                   0.0100465, 0.0103897, 0.0108341, 0.011288, 0.0116823, 0.0122003, 0.0125133, 0.0130844, 0.0133403, 0.0143026, 0.0156835, 0.0186025, 0.0313603, 
                   0.0143073, 0.014909, 0.0152098, 0.015699, 0.0160421, 0.0165452, 0.0164545, 0.0176419, 0.017957, 0.0189819, 0.0210084, 0.0280581, 0.0365486, 
                   0.0170051, 0.0175944, 0.0178314, 0.0186037, 0.0188804, 0.0195753, 0.0197699, 0.0200236, 0.0208149, 0.024422, 0.0249905, 0.0282694, 0.0351899, 
                   0.0180785, 0.0189118, 0.0193028, 0.0200497, 0.0198258, 0.0210637, 0.0218855, 0.0204799, 0.0226662, 0.0287832, 0.0315873, 0.0350436, 0.046474};
   const float SmearingTool::sig2MuPlus[104]={
                   0.0286708, 0.0322033, 0.0317214, 0.0325402, 0.034172, 0.0339839, 0.0358597, 0.0399923, 0.0430327, 3, 3, 3, 3, 
                   0.0303499, 0.0335461, 0.035186, 0.0355351, 0.037515, 0.0400834, 0.0353321, 0.0433541, 0.0449698, 3, 3, 3, 3, 
                   0.0267534, 0.028524, 0.0305584, 0.0305369, 0.0309554, 0.032102, 0.0339962, 0.0350724, 0.0402999, 0.0356422, 0.0391648, 3, 3, 
                   0.0244015, 0.0258655, 0.0272168, 0.0283938, 0.0304235, 0.0308974, 0.0327854, 0.0325089, 0.0342846, 0.0341406, 0.0409782, 0.0443946, 3, 
                   0.0238573, 0.0246461, 0.0259217, 0.0277561, 0.0288417, 0.0302664, 0.0308348, 0.0330946, 0.0318596, 0.0367325, 0.0355155, 0.0440298, 3, 
                   0.0280403, 0.0297546, 0.0297652, 0.0315007, 0.0316255, 0.03222, 0.0304121, 0.0357268, 0.0333407, 0.04031, 0.0415943, 3, 3, 
                   0.030784, 0.0323555, 0.0334505, 0.0365247, 0.0354992, 0.0397981, 0.0394763, 0.0393931, 0.0381156, 3, 3, 3, 3, 
                   0.0302841, 0.0323235, 0.0320732, 0.0337731, 0.0325786, 0.0341896, 0.0366978, 0.0356134, 0.0368251, 3, 3, 3, 3};
   const float SmearingTool::Asig2MuPlus[104]={
                   0.22207, 0.152082, 0.201202, 0.21227, 0.177595, 0.228996, 0.248839, 0.143536, 0.121658, 0, 0, 0, 0, 
                   0.0875288, 0.0699811, 0.0622945, 0.0661255, 0.0596489, 0.0530692, 0.0990056, 0.04461, 0.0447531, 0, 0, 0, 0, 
                   0.0750791, 0.0756986, 0.0664586, 0.0789327, 0.0808668, 0.0886702, 0.0757271, 0.0821508, 0.04151, 0.11933, 0.0994572, 0, 0, 
                   0.0376013, 0.0380438, 0.0379053, 0.037482, 0.0364278, 0.0409791, 0.0372385, 0.0425693, 0.0449873, 0.0555236, 0.0442444, 0.0632063, 0, 
                   0.0380559, 0.0452239, 0.0439547, 0.0405967, 0.0422581, 0.0413137, 0.0463617, 0.0424255, 0.0534375, 0.0437842, 0.0693719, 0.075412, 0, 
                   0.0673416, 0.0639165, 0.081217, 0.0724329, 0.0829518, 0.0885582, 0.142358, 0.0896564, 0.111271, 0.0793521, 0.0805475, 0, 0, 
                   0.0805014, 0.084618, 0.0865728, 0.0620484, 0.0751758, 0.0503472, 0.0650512, 0.0689043, 0.0926338, 0, 0, 0, 0, 
                   0.15444, 0.156721, 0.201724, 0.176711, 0.273702, 0.228517, 0.224287, 0.398, 0.336167, 0, 0, 0, 0};

   const float SmearingTool::ERRmeanMuPlus[104]={
                   8.4163e-05, 7.18788e-05, 6.44673e-05, 5.93369e-05, 7.36071e-05, 0.000127437, 0.000199619, 0.00028197, 0.000386131, 0.000397515, 0.000554943, 0.00101484, 0.00416213, 
                   8.08523e-05, 6.75481e-05, 5.78438e-05, 4.9801e-05, 6.06388e-05, 0.00010129, 0.000156156, 0.000218349, 0.000291947, 0.000299249, 0.000399746, 0.000665788, 0.00183929, 
                   6.45251e-05, 5.32373e-05, 4.40869e-05, 3.84523e-05, 4.87412e-05, 8.17039e-05, 0.000123322, 0.000176677, 0.000232121, 0.00024169, 0.000341521, 0.000595108, 0.0015712, 
                   2.95103e-05, 2.27301e-05, 1.9523e-05, 1.83902e-05, 2.3845e-05, 4.02188e-05, 6.15311e-05, 8.58203e-05, 0.000116628, 0.000120911, 0.000167944, 0.000288103, 0.000833289, 
                   2.96581e-05, 2.28127e-05, 1.95262e-05, 1.84938e-05, 2.39994e-05, 4.03779e-05, 6.14233e-05, 8.70062e-05, 0.000116534, 0.000121775, 0.000171352, 0.000293423, 0.000852157, 
                   6.57514e-05, 5.33546e-05, 4.46681e-05, 3.87921e-05, 4.91335e-05, 8.29647e-05, 0.000125253, 0.000179008, 0.00023623, 0.000244584, 0.000341676, 0.000581722, 0.00156541, 
                   8.08688e-05, 6.72859e-05, 5.8084e-05, 4.99309e-05, 6.07431e-05, 0.000102081, 0.000155466, 0.000215151, 0.000291094, 0.000305699, 0.000393871, 0.000654803, 0.00177389, 
                   8.30048e-05, 7.07242e-05, 6.38498e-05, 5.86187e-05, 7.29404e-05, 0.000125028, 0.000197211, 0.000280445, 0.000383572, 0.000396503, 0.00055413, 0.000947417, 0.00321979};
   const float SmearingTool::ERRsig1MuPlus[104]={
                   0.000268119, 0.000203882, 0.000204734, 0.000195499, 0.000229613, 0.000475393, 0.000697991, 0.00103305, 0.00140665, 0.000286194, 0.00040738, 0.000797512, 0.00447569, 
                   0.000165398, 0.000126906, 0.00010221, 9.22412e-05, 0.000105575, 0.000174766, 0.000333998, 0.000377748, 0.00048523, 0.000212216, 0.00028407, 0.000480068, 0.00142986, 
                   0.000112323, 9.30212e-05, 7.20576e-05, 6.66533e-05, 8.87443e-05, 0.000145179, 0.000209407, 0.000318214, 0.000363514, 0.0005379, 0.000750373, 0.000427834, 0.00121862, 
                   3.6703e-05, 2.76292e-05, 2.38834e-05, 2.22873e-05, 2.79154e-05, 4.90977e-05, 7.31864e-05, 0.000108968, 0.000145935, 0.000163656, 0.00021827, 0.000453135, 0.000609031, 
                   3.72919e-05, 2.98678e-05, 2.46332e-05, 2.29464e-05, 2.97558e-05, 4.96976e-05, 7.7493e-05, 0.000106173, 0.000160705, 0.000151077, 0.00026018, 0.000447953, 0.000626014, 
                   0.000112791, 8.5969e-05, 7.72349e-05, 6.4942e-05, 8.66534e-05, 0.000153493, 0.000273594, 0.000363925, 0.000446758, 0.000378228, 0.000686317, 0.00041747, 0.00122175, 
                   0.000156259, 0.000128614, 0.00011097, 8.74766e-05, 0.000118076, 0.000181533, 0.000279743, 0.00038438, 0.000757937, 0.000216798, 0.000279627, 0.000470441, 0.00135939, 
                   0.000235767, 0.00019133, 0.000193569, 0.000171274, 0.000262872, 0.000450168, 0.000686622, 0.0010715, 0.00171051, 0.000285714, 0.000407929, 0.000724843, 0.00293962};
   const float SmearingTool::ERRsig2MuPlus[104]={
                   0.000683462, 0.000777052, 0.000619401, 0.000572424, 0.000831674, 0.0013938, 0.00202129, 0.0055067, 0.00965578, 0, 0, 0, 0, 
                   0.000928761, 0.000915526, 0.000849579, 0.000744872, 0.000986553, 0.0019279, 0.00199188, 0.00557196, 0.0077145, 0, 0, 0, 0, 
                   0.000643808, 0.000535927, 0.000474581, 0.000387346, 0.000513828, 0.000807073, 0.00138091, 0.00204026, 0.00472508, 0.00253041, 0.00508549, 0, 0, 
                   0.000328482, 0.000247842, 0.000216322, 0.000206625, 0.000273593, 0.000443721, 0.000745675, 0.000991361, 0.00134614, 0.00128811, 0.00255326, 0.00476877, 0, 
                   0.000331947, 0.000232897, 0.000200025, 0.000199575, 0.000254972, 0.000444077, 0.000643113, 0.000995541, 0.00120714, 0.00152694, 0.00181793, 0.00416368, 0, 
                   0.000701098, 0.000579596, 0.000432963, 0.000411362, 0.000496886, 0.000848349, 0.00099757, 0.00213254, 0.0022592, 0.00310453, 0.00588645, 0, 0, 
                   0.000943149, 0.000775005, 0.000669035, 0.000756576, 0.000858324, 0.00207454, 0.00261201, 0.00348603, 0.00509408, 0, 0, 0, 0, 
                   0.00082687, 0.000706544, 0.000583547, 0.000608636, 0.000613711, 0.00131878, 0.00221344, 0.00188352, 0.00391305, 0, 0, 0, 0};
   const float SmearingTool::ERRAsig2MuPlus[104]={
                   0.0379535, 0.0230174, 0.0267136, 0.0251054, 0.0271845, 0.063817, 0.086973, 0.0998405, 0.119287, 0, 0, 0, 0, 
                   0.0151887, 0.00969327, 0.00711217, 0.0066369, 0.00692321, 0.0102131, 0.0287937, 0.0210491, 0.026615, 0, 0, 0, 0, 
                   0.00955993, 0.00728978, 0.0049296, 0.00493567, 0.0067978, 0.0107351, 0.0139439, 0.0216437, 0.0182423, 0.0396142, 0.0585392, 0, 0, 
                   0.00203119, 0.00142234, 0.00116408, 0.00103833, 0.00118506, 0.00215927, 0.00301242, 0.00478493, 0.00623366, 0.00775434, 0.00855069, 0.0214165, 0, 
                   0.00217698, 0.00175554, 0.00136456, 0.0011385, 0.00143662, 0.00229183, 0.00365392, 0.00457759, 0.00788455, 0.00610367, 0.0138282, 0.0224556, 0, 
                   0.00856521, 0.00603773, 0.00588467, 0.00448175, 0.00631857, 0.0114437, 0.0255968, 0.0241328, 0.0379515, 0.02281, 0.0457593, 0, 0, 
                   0.0135119, 0.0106244, 0.00872188, 0.00578341, 0.0088408, 0.0107384, 0.0179046, 0.0256204, 0.0597606, 0, 0, 0, 0, 
                   0.0274001, 0.020871, 0.0240132, 0.0195964, 0.0357301, 0.0585729, 0.080146, 0.252178, 0.341487, 0, 0, 0, 0};

   const float SmearingTool::ResRMSMuPlus[104]={
                   0.0210985, 0.0223357, 0.0229999, 0.0236404, 0.0241798, 0.0250557, 0.0262903, 0.026826, 0.0277184, 0.0285485, 0.0310186, 0.0359394, 0.0464353, 
                   0.0193296, 0.0203034, 0.0206333, 0.0211037, 0.0215648, 0.0220325, 0.0225197, 0.0230839, 0.0236784, 0.024373, 0.0254018, 0.028794, 0.0353286, 
                   0.0161781, 0.0170874, 0.0176515, 0.018234, 0.0187374, 0.0193771, 0.0198461, 0.0207409, 0.0208338, 0.0222129, 0.0243195, 0.0283213, 0.0351918, 
                   0.0118927, 0.0125092, 0.0131048, 0.0135981, 0.0142767, 0.0148753, 0.0154633, 0.015852, 0.0167144, 0.0175429, 0.0194215, 0.0228428, 0.030523, 
                   0.0117933, 0.0124797, 0.0130199, 0.0135985, 0.0141808, 0.0147854, 0.0153641, 0.0160435, 0.01644, 0.0176531, 0.0193754, 0.0232602, 0.031109, 
                   0.0164762, 0.0171955, 0.0178696, 0.0183951, 0.0189376, 0.0195562, 0.0201011, 0.0212059, 0.0212647, 0.0227664, 0.0242936, 0.0279835, 0.0356293, 
                   0.0192635, 0.0201231, 0.0206119, 0.0210886, 0.021463, 0.0219186, 0.0225509, 0.0228408, 0.0237789, 0.0244031, 0.0249747, 0.0281956, 0.0344352, 
                   0.0211009, 0.0223045, 0.0230524, 0.0237226, 0.0243341, 0.0250703, 0.0263605, 0.0272427, 0.0279848, 0.0286794, 0.031319, 0.0343447, 0.042152};
   const float SmearingTool::ErrResRMSMuPlus[104]={
                   6.05863e-05, 5.17596e-05, 4.62831e-05, 4.25658e-05, 5.27002e-05, 9.08232e-05, 0.000142253, 0.000199396, 0.000271515, 0.000279243, 0.000386346, 0.000676538, 0.00202084, 
                   5.84607e-05, 4.89815e-05, 4.20096e-05, 3.60881e-05, 4.40204e-05, 7.36424e-05, 0.000112932, 0.000157717, 0.000210327, 0.000211293, 0.000282277, 0.00046747, 0.00123524, 
                   4.72838e-05, 3.91634e-05, 3.25748e-05, 2.839e-05, 3.58081e-05, 6.04896e-05, 9.12893e-05, 0.00013049, 0.000169735, 0.000179183, 0.000246444, 0.000418578, 0.00105724, 
                   2.25575e-05, 1.75097e-05, 1.50748e-05, 1.42241e-05, 1.86285e-05, 3.14241e-05, 4.78716e-05, 6.66202e-05, 9.11899e-05, 9.4013e-05, 0.000130173, 0.000217088, 0.000581417, 
                   2.24909e-05, 1.74675e-05, 1.49837e-05, 1.4257e-05, 1.85754e-05, 3.1245e-05, 4.77387e-05, 6.78169e-05, 9.00635e-05, 9.50633e-05, 0.000130909, 0.000222874, 0.00059301, 
                   4.8338e-05, 3.93222e-05, 3.29874e-05, 2.87037e-05, 3.63255e-05, 6.11997e-05, 9.23078e-05, 0.000132828, 0.000173027, 0.000181465, 0.000247456, 0.000409227, 0.00105065, 
                   5.86409e-05, 4.88687e-05, 4.23566e-05, 3.63546e-05, 4.4037e-05, 7.40511e-05, 0.000113131, 0.000156283, 0.000209475, 0.000215914, 0.000278185, 0.000460556, 0.00120253, 
                   5.97857e-05, 5.1115e-05, 4.60228e-05, 4.21771e-05, 5.24659e-05, 8.93094e-05, 0.000140742, 0.000201033, 0.00027064, 0.000278428, 0.000385219, 0.000643561, 0.00186652};

   ////// End smearing parametrization for single muon plus:

SmearingTool::SmearingTool(){
}
float SmearingTool::PTsmear(float PTmuonGen, float ETAmuonGen, float CHARGEmuonGen, float PTmuonReco, int Ismear, TString ParVar,float ParSig){
   //Ismear = 1 - Smear with RND (no RECO use), Ismear = 2 - Smear with SF for RECO and GEN
   if(Ismear != 1 && Ismear != 2)std::cout << "ERROR SmearingTool::PTsmear: set Ismear to 1 or 2 for smearing" << std::endl;
   const int NPThist = (sizeof(PTbin)/sizeof(float)-1);
   const int NETAhist = (sizeof(ETAbin)/sizeof(float)-1);
   //const int Nhist = NPThist*NETAhist;
   ////// Make smearing for single muon from Gen level PostFSR:
   float PTmuonSmear = -10.;
   float meanVar = 0;
   float sigVar = 0;//for sig1 and sig2
   float Asig2Var = 0;
   if(ParVar == "mean")meanVar = ParSig;
   if(ParVar == "sig1" || ParVar == "sig2")sigVar = ParSig;
   if(ParVar == "Asig2Var")Asig2Var = ParSig;
   int iK_cand = -1;
   for(int iPT = 0; iPT < NPThist; iPT++){
   for(int iETA = 0; iETA < NETAhist; iETA++){
      int iK = iPT + iETA*NPThist;
      // smear muons which out of range PT and ETA
      float PTcutDown = PTbin[iPT];
      float PTcutUp = PTbin[iPT+1];
      if(iPT == 0 && PTmuonGen < PTbin[0])PTcutDown = PTmuonGen-0.001;
      if(iPT == (NPThist-1) && PTmuonGen > PTbin[NPThist])PTcutUp = PTmuonGen+0.001;
      float ETAcutDown = ETAbin[iETA];
      float ETAcutUp = ETAbin[iETA+1];
      if(iETA == 0 && ETAmuonGen < ETAbin[0])ETAcutDown = ETAmuonGen-0.001;
      if(iETA == (NETAhist-1) && ETAmuonGen >= ETAbin[NETAhist])ETAcutUp = ETAmuonGen+0.001;
      if(PTmuonGen >= PTcutDown && PTmuonGen < PTcutUp
      && ETAmuonGen >= ETAcutDown && ETAmuonGen < ETAcutUp) iK_cand = iK;
   }}

   ///// Set Scale Factor
   float ScaleFactor = 1.;
   if (fabs(ETAmuonGen) < 0.8) ScaleFactor = 1.21;
   if (fabs(ETAmuonGen) >= 0.8 && fabs(ETAmuonGen) < 1.2) ScaleFactor = 1.16;
   if (fabs(ETAmuonGen) >= 1.2) ScaleFactor = 1.11;
   TF1* fitDoubleGauss = new TF1("fitDoubleGauss", DoubleGauss, -0.1, 0.1, 5);
   fitDoubleGauss->SetParameter(4,1.);
   if(iK_cand > -1 && Ismear == 1 && CHARGEmuonGen < 0){
      float meanCorr = mean[iK_cand] + meanVar*ERRmean[iK_cand];
      float sig1Corr = sig1[iK_cand] + sigVar*ERRsig1[iK_cand];
      if(sig1Corr < 0.005) sig1Corr = 0.005;
      float sig2Corr = sig2[iK_cand] + sigVar*ERRsig2[iK_cand];
      if(sig2Corr < 0.005) sig2Corr = 0.005;
      float Asig2Corr = Asig2[iK_cand] + Asig2Var*ERRAsig2[iK_cand];
      if(Asig2Corr < 0.) Asig2Corr = 0.;
      fitDoubleGauss->SetParameter(0,meanCorr);
      fitDoubleGauss->SetParameter(1,ScaleFactor*sig1Corr);
      fitDoubleGauss->SetParameter(2,Asig2Corr);
      fitDoubleGauss->SetParameter(3,ScaleFactor*sig2Corr);
      Double_t resSim = fitDoubleGauss->GetRandom();
      PTmuonSmear = PTmuonGen*(1+resSim);
   }
   if(iK_cand > -1 && Ismear == 1 && CHARGEmuonGen > 0){
      float meanCorr = meanMuPlus[iK_cand] + meanVar*ERRmeanMuPlus[iK_cand];
      float sig1Corr = sig1MuPlus[iK_cand] + sigVar*ERRsig1MuPlus[iK_cand];
      if(sig1Corr < 0.005) sig1Corr = 0.005;
      float sig2Corr = sig2MuPlus[iK_cand] + sigVar*ERRsig2MuPlus[iK_cand];
      if(sig2Corr < 0.005) sig2Corr = 0.005;
      float Asig2Corr = Asig2MuPlus[iK_cand] + Asig2Var*ERRAsig2MuPlus[iK_cand];
      if(Asig2Corr < 0.) Asig2Corr = 0.;
      fitDoubleGauss->SetParameter(0,meanCorr);
      fitDoubleGauss->SetParameter(1,ScaleFactor*sig1Corr);
      fitDoubleGauss->SetParameter(2,Asig2Corr);
      fitDoubleGauss->SetParameter(3,ScaleFactor*sig2Corr);
      Double_t resSim = fitDoubleGauss->GetRandom();
      PTmuonSmear = PTmuonGen*(1+resSim);
   }
   delete fitDoubleGauss;
   if(iK_cand > -1 && Ismear == 2){
      PTmuonSmear = PTmuonGen + ScaleFactor*(PTmuonReco - PTmuonGen);
   }
   ////// End Smearing parametrization for single muon:

   return PTmuonSmear;
 }//end PTsmear function

   Double_t DoubleGauss(Double_t *x, Double_t *par)
   {
       double dgauss = 0.;
        if(par[1] < par[3]){//not normalized gauss both gauss are  = 1 at x[0]=par[0]
                  dgauss =  exp(-0.5*(x[0]-par[0])*(x[0]-par[0])/par[1]/par[1]);
                  dgauss = dgauss + par[2]*exp(-0.5*(x[0]-par[0])*(x[0]-par[0])/par[3]/par[3]);
                  dgauss = par[4]*dgauss;
        }
       return dgauss;
   }
