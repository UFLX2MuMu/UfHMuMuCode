#include <SmearingTool.h>

// couldn't be inside class due to root feacher during TF1 creation:
Double_t DoubleGauss(Double_t*, Double_t* );

   const float SmearingTool::PTbin[14]={25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 80, 100, 150, 300};
   const float SmearingTool::ETAbin[9]={-2.1, -1.6, -1.2, -0.8, 0, 0.8, 1.2, 1.6, 2.1};

   ////// Smearing parametrization for single muon:
   const float SmearingTool::mean[104]={
                   0.00146639, 0.000458943, 0.000285136, 0.00032543, 0.0003739, 0.000134528, -0.000276853, -0.00050787, 2.43767e-05, -0.0011567, -0.00159462, -0.00437933, -0.00808635, 
                   0.00139331, 0.000416941, 0.000399766, 0.000459446, 0.00055438, 0.000363417, 0.000713105, 2.26977e-05, -2.4754e-05, 0.000665973, 0.000886652, 0.000925694, -0.0033322, 
                   0.000867904, 0.000188679, 0.000229559, 0.000196372, 0.000162359, 0.000180308, 0.000133188, -4.61758e-05, -0.000174348, 5.36687e-05, -7.98273e-05, 0.000917085, -0.000557838, 
                   7.41712e-05, -0.000122472, -0.00013857, -0.000155352, -0.000189739, -0.000212652, -0.000124664, -0.000122943, -0.000316995, -0.000175489, -0.000232266, -0.000166598, -0.000526338, 
                   0.000276781, -1.76725e-05, 1.42975e-05, -1.71197e-05, -6.50104e-05, -9.60496e-05, -9.61148e-05, -0.0001092, -0.000388411, -0.000249926, 3.2751e-05, -0.00117718, -0.000971893, 
                   0.000846421, 0.000229481, 0.000235174, 0.000171343, 7.53808e-05, 0.000183559, -8.68992e-05, -0.000186994, 0.000620129, -0.00052287, 0.000400846, 0.000466057, -0.00210583, 
                   0.00128652, 0.000475111, 0.000441052, 0.000520089, 0.000382571, 0.000314527, 0.00025387, 7.12394e-05, 0.000298178, 0.000689985, 0.00142159, 0.000664402, -0.00110746, 
                   0.00142559, 0.000476032, 0.000327271, 0.000308441, 0.000258766, 0.000229982, -0.000379751, -0.000427471, 1.64402e-05, 0.000318521, 0.000258598, -0.00202024, -0.000115606};
   const float SmearingTool::sig1[104]={
                   0.0183656, 0.0199031, 0.0201678, 0.0212307, 0.0216584, 0.0218517, 0.0223747, 0.025358, 0.0238186, 0.0308492, 0.0336446, 0.0384313, 0.0560951, 
                   0.0176635, 0.0186525, 0.0191988, 0.0201344, 0.0206886, 0.021641, 0.0223794, 0.0233221, 0.0222978, 0.0271861, 0.029487, 0.035091, 0.0455325, 
                   0.0149668, 0.0159121, 0.0165013, 0.0171066, 0.0179084, 0.0186986, 0.0194451, 0.019445, 0.0211869, 0.0212901, 0.024099, 0.0343771, 0.0475902, 
                   0.010952, 0.0118241, 0.0125746, 0.0134581, 0.0142661, 0.014902, 0.0159166, 0.0167914, 0.0179494, 0.018776, 0.0221693, 0.0277963, 0.0427287, 
                   0.0109991, 0.0118519, 0.0125545, 0.0133945, 0.0141461, 0.0149348, 0.0159279, 0.0168547, 0.0181479, 0.0192932, 0.0215682, 0.0269604, 0.0451701, 
                   0.0150267, 0.01595, 0.0166141, 0.0172491, 0.0178561, 0.018632, 0.0199129, 0.0211754, 0.0211972, 0.0226758, 0.0260151, 0.0351044, 0.0476184, 
                   0.0174301, 0.0185502, 0.0191676, 0.0201684, 0.0206967, 0.0211447, 0.0224811, 0.0234119, 0.0207408, 0.0275254, 0.0292714, 0.0352805, 0.0455742, 
                   0.0182879, 0.0200417, 0.0200671, 0.0211662, 0.0218318, 0.021621, 0.0225667, 0.0227612, 0.0249202, 0.0310834, 0.0344459, 0.042123, 0.0580869};
   const float SmearingTool::sig2[104]={
                   0.0302949, 0.0329067, 0.0327329, 0.0348727, 0.0338392, 0.0344203, 0.0336187, 0.0459613, 0.0364961, 3, 3, 3, 3, 
                   0.0313553, 0.0339246, 0.034892, 0.0371413, 0.0375961, 0.0414514, 0.0423653, 0.0455287, 0.0379192, 3, 3, 3, 3, 
                   0.0295407, 0.0307551, 0.0320012, 0.0317467, 0.0332689, 0.0359954, 0.0351327, 0.0309069, 0.0354254, 0.0346835, 0.0383916, 3, 3, 
                   0.0246142, 0.0280824, 0.0291753, 0.0317876, 0.0334835, 0.0331533, 0.0365306, 0.036095, 0.0450531, 0.0379345, 0.0540481, 0.1, 3, 
                   0.0251202, 0.027239, 0.028287, 0.0297677, 0.0307974, 0.0331934, 0.0337879, 0.0381375, 0.0445232, 0.0431438, 0.0449735, 0.0479431, 3, 
                   0.0285465, 0.0314456, 0.0319795, 0.0326009, 0.0331527, 0.0340247, 0.0382848, 0.0386311, 0.0363234, 0.0432417, 0.074471, 3, 3, 
                   0.0315073, 0.0320145, 0.0353926, 0.0370709, 0.0385012, 0.0373419, 0.0466196, 0.044336, 0.0323213, 3, 3, 3, 3, 
                   0.0311115, 0.0339159, 0.0322965, 0.0344771, 0.0352056, 0.0342676, 0.0339256, 0.037064, 0.0412508, 3, 3, 3, 3};
   const float SmearingTool::Asig2[104]={
                   0.157455, 0.131685, 0.179019, 0.15153, 0.215091, 0.281257, 0.4, 0.0891721, 0.4, 0, 0, 0, 0, 
                   0.0836766, 0.0787044, 0.0797807, 0.0649102, 0.073821, 0.0520506, 0.0554617, 0.0365514, 0.137944, 0, 0, 0, 0, 
                   0.0603327, 0.0598384, 0.0646754, 0.0796395, 0.0762716, 0.067071, 0.0863685, 0.20963, 0.121977, 0.230828, 0.226233, 0, 0, 
                   0.0391723, 0.0314325, 0.0352684, 0.0318483, 0.0312876, 0.0423551, 0.037481, 0.0431898, 0.0246304, 0.0585563, 0.0296461, 0.0292346, 0, 
                   0.0354554, 0.0341709, 0.0398245, 0.0388738, 0.0416558, 0.040136, 0.0443733, 0.0354274, 0.0249197, 0.035597, 0.0490132, 0.110559, 0, 
                   0.0679073, 0.0593275, 0.0654366, 0.0776697, 0.0846394, 0.0902921, 0.0637301, 0.0662734, 0.141482, 0.0796579, 0.0214093, 0, 0, 
                   0.0820368, 0.0972147, 0.0714627, 0.0589499, 0.0605089, 0.089752, 0.0398795, 0.0514789, 0.360671, 0, 0, 0, 0, 
                   0.147832, 0.117399, 0.221723, 0.176427, 0.182706, 0.318326, 0.4, 0.4, 0.239429, 0, 0, 0, 0};

   const float SmearingTool::ERRmean[104]={
                   8.49974e-05, 7.23556e-05, 6.50695e-05, 6.0341e-05, 7.56105e-05, 0.000129942, 0.00020119, 0.00029206, 0.000393928, 0.000411775, 0.000573188, 0.00100938, 0.00398768, 
                   8.35859e-05, 7.01335e-05, 6.06521e-05, 5.29213e-05, 6.54785e-05, 0.000110458, 0.000172401, 0.000237296, 0.000319897, 0.000332397, 0.000452362, 0.000802815, 0.00229809, 
                   6.81354e-05, 5.63648e-05, 4.7517e-05, 4.192e-05, 5.37278e-05, 9.12392e-05, 0.000140768, 0.000199114, 0.000273039, 0.000286238, 0.000399425, 0.00071423, 0.00219919, 
                   3.21255e-05, 2.54788e-05, 2.2348e-05, 2.16225e-05, 2.85651e-05, 4.88203e-05, 7.59273e-05, 0.000109397, 0.000148943, 0.000157058, 0.000224724, 0.000413617, 0.00121476, 
                   3.23234e-05, 2.55961e-05, 2.24416e-05, 2.16982e-05, 2.86488e-05, 4.89219e-05, 7.63895e-05, 0.000109005, 0.000150377, 0.000158415, 0.000224266, 0.000419923, 0.00130906, 
                   6.85693e-05, 5.68177e-05, 4.78359e-05, 4.25025e-05, 5.43175e-05, 9.2196e-05, 0.000142842, 0.000205799, 0.000279935, 0.000286333, 0.000397903, 0.000733126, 0.00218959, 
                   8.27899e-05, 7.05491e-05, 6.05467e-05, 5.30292e-05, 6.51367e-05, 0.000111865, 0.00017064, 0.00024867, 0.000318118, 0.000339099, 0.000454523, 0.000807371, 0.00234765, 
                   8.3578e-05, 7.22866e-05, 6.50146e-05, 6.02424e-05, 7.51965e-05, 0.000129551, 0.000200716, 0.000294947, 0.000397947, 0.000410644, 0.000589232, 0.00113327, 0.00428431};
   const float SmearingTool::ERRsig1[104]={
                   0.000235987, 0.000195772, 0.000203646, 0.00019062, 0.000300399, 0.000591914, 0.000331689, 0.000925461, 0.000676979, 0.000301186, 0.00043118, 0.000810122, 0.00423138, 
                   0.000168232, 0.000141817, 0.000124933, 0.000107001, 0.00014265, 0.00022158, 0.00033781, 0.000469271, 0.000914994, 0.00023758, 0.000327429, 0.000614547, 0.00206849, 
                   0.000110265, 9.41289e-05, 8.2419e-05, 8.04907e-05, 0.000102329, 0.000162726, 0.000309779, 0.000641625, 0.000739049, 0.00110785, 0.00183194, 0.000541884, 0.00205223, 
                   4.19655e-05, 3.05522e-05, 2.74088e-05, 2.6081e-05, 3.4931e-05, 6.40099e-05, 9.93336e-05, 0.00015948, 0.000186163, 0.000265086, 0.000355395, 0.000437842, 0.00104382, 
                   4.12251e-05, 3.13393e-05, 2.87455e-05, 2.81349e-05, 3.85779e-05, 6.36123e-05, 0.000112088, 0.000145197, 0.000188654, 0.00023315, 0.000414963, 0.00143188, 0.00117214, 
                   0.000120303, 9.47343e-05, 8.22068e-05, 7.74359e-05, 0.000104038, 0.000189799, 0.000277515, 0.000452412, 0.000842182, 0.000648127, 0.000927197, 0.000561275, 0.00204338, 
                   0.000164628, 0.000159458, 0.000120077, 0.00010682, 0.000132094, 0.000274664, 0.000312232, 0.00058768, 0.00114255, 0.000242729, 0.000328549, 0.00061953, 0.00211612, 
                   0.000213687, 0.000188754, 0.000229396, 0.000201992, 0.00027775, 0.000569268, 0.000332633, 0.000467341, 0.00179082, 0.000300938, 0.000447406, 0.000963974, 0.00476289};
   const float SmearingTool::ERRsig2[104]={
                   0.000840577, 0.000884908, 0.000706827, 0.000816861, 0.000941733, 0.00147163, 0.000374815, 0.00959063, 0.00078274, 0, 0, 0, 0, 
                   0.00101367, 0.000956791, 0.00086592, 0.000956025, 0.00117794, 0.00280506, 0.0043176, 0.00959182, 0.00477292, 0, 0, 0, 0, 
                   0.000777717, 0.000692612, 0.000584995, 0.000491392, 0.000682436, 0.00131116, 0.00201661, 0.00188085, 0.00393179, 0.0032264, 0.00651382, 0, 0, 
                   0.000372479, 0.000327165, 0.000276952, 0.000298793, 0.000425799, 0.000629248, 0.00117682, 0.00171352, 0.00415043, 0.00250411, 0.0108744, 0.0760745, 0, 
                   0.000393386, 0.00031665, 0.000262904, 0.000270186, 0.00036092, 0.00065194, 0.00109595, 0.00192798, 0.0041711, 0.0038516, 0.00608133, 0.0134676, 0, 
                   0.000766962, 0.000704657, 0.000587132, 0.000496077, 0.000637793, 0.00114356, 0.00255062, 0.00424615, 0.00387542, 0.00625668, 0.082226, 0, 0, 
                   0.000997319, 0.000876784, 0.00092213, 0.0010306, 0.0013204, 0.0019478, 0.00600927, 0.00870967, 0.00227704, 0, 0, 0, 0, 
                   0.000803355, 0.000958694, 0.000649111, 0.000751377, 0.00103358, 0.00126097, 0.000377431, 0.000528741, 0.00672495, 0, 0, 0, 0};
   const float SmearingTool::ERRAsig2[104]={
                   0.0288198, 0.0221251, 0.0257142, 0.0221128, 0.0428458, 0.0852384, 0.269743, 0.0758206, 0.259497, 0, 0, 0, 0, 
                   0.0151323, 0.0115987, 0.0101923, 0.00808175, 0.0113517, 0.0148977, 0.0234855, 0.0290446, 0.0914001, 0, 0, 0, 0, 
                   0.0078385, 0.00675411, 0.0058317, 0.00648303, 0.00800835, 0.0113352, 0.0257383, 0.0883883, 0.0766918, 0.131358, 0.295847, 0, 0, 
                   0.00258127, 0.00148001, 0.0013662, 0.00117442, 0.00153984, 0.00326748, 0.00454477, 0.00837489, 0.00673553, 0.016318, 0.0151723, 0.00480705, 0, 
                   0.00238074, 0.00166036, 0.00156784, 0.00150248, 0.00210718, 0.00320844, 0.00620432, 0.00665835, 0.00712603, 0.0109, 0.0235757, 0.119676, 0, 
                   0.0095934, 0.00646846, 0.00595256, 0.00594848, 0.00834213, 0.0157651, 0.019055, 0.0346062, 0.083032, 0.0468719, 0.0360037, 0, 0, 
                   0.0141683, 0.0155308, 0.00928357, 0.00798737, 0.00966746, 0.0241294, 0.0177254, 0.0406184, 0.341238, 0, 0, 0, 0, 
                   0.0235864, 0.0195858, 0.0311918, 0.0248044, 0.0349411, 0.083029, 0.252792, 0.282133, 0.294612, 0, 0, 0, 0};

   const float SmearingTool::ResRMS[104]={
                   0.0213114, 0.0226634, 0.0234529, 0.0243529, 0.0250887, 0.0261035, 0.0268971, 0.0281709, 0.0288175, 0.0306496, 0.0331526, 0.036993, 0.0463449, 
                   0.0199019, 0.021054, 0.0216647, 0.0223587, 0.0230807, 0.0237228, 0.0245328, 0.0249112, 0.0256033, 0.0271256, 0.0293547, 0.0343884, 0.0416516, 
                   0.017071, 0.0179708, 0.0187969, 0.0195389, 0.0203463, 0.0212175, 0.0220557, 0.0227683, 0.0239884, 0.0253944, 0.0280687, 0.0337689, 0.042849, 
                   0.0125979, 0.0135674, 0.0144743, 0.0154048, 0.0162312, 0.0171597, 0.0182338, 0.0190352, 0.0200246, 0.0213516, 0.0243352, 0.0302089, 0.0400103, 
                   0.0125965, 0.0135451, 0.0144778, 0.015307, 0.0161461, 0.0170872, 0.0180675, 0.0190466, 0.0201381, 0.0214944, 0.0240272, 0.0300465, 0.0414638, 
                   0.017089, 0.0181388, 0.0188924, 0.0197935, 0.0204997, 0.0213534, 0.0223726, 0.0234103, 0.0246032, 0.0256434, 0.0276992, 0.0343702, 0.0428778, 
                   0.0197467, 0.0209371, 0.0215277, 0.0221986, 0.022869, 0.0237498, 0.0244916, 0.0254185, 0.0253487, 0.027468, 0.0291372, 0.0345337, 0.0417122, 
                   0.0214017, 0.0227878, 0.0237622, 0.0245602, 0.0252533, 0.0262712, 0.0271332, 0.0286909, 0.0295578, 0.0308485, 0.0338492, 0.0396112, 0.0471839};
   const float SmearingTool::ErrResRMS[104]={
                   6.11806e-05, 5.1924e-05, 4.66408e-05, 4.30851e-05, 5.37584e-05, 9.2336e-05, 0.0001421, 0.000205054, 0.000274914, 0.000287312, 0.00039356, 0.00066101, 0.00189518, 
                   6.03011e-05, 5.06962e-05, 4.37791e-05, 3.80349e-05, 4.69762e-05, 7.89165e-05, 0.000122747, 0.000168158, 0.00022696, 0.00023412, 0.000317056, 0.00054523, 0.00135853, 
                   4.99627e-05, 4.1126e-05, 3.47382e-05, 3.05123e-05, 3.90167e-05, 6.63307e-05, 0.000101685, 0.000142676, 0.000195305, 0.000204263, 0.000280351, 0.000487615, 0.00125917, 
                   2.40049e-05, 1.91389e-05, 1.67673e-05, 1.62031e-05, 2.13141e-05, 3.63951e-05, 5.65282e-05, 8.05462e-05, 0.000109833, 0.000114588, 0.00016159, 0.000287222, 0.000753171, 
                   2.41539e-05, 1.91312e-05, 1.67953e-05, 1.61455e-05, 2.12495e-05, 3.63744e-05, 5.62695e-05, 8.04766e-05, 0.000110485, 0.000115441, 0.000161151, 0.000290988, 0.000780255, 
                   5.00729e-05, 4.16044e-05, 3.49466e-05, 3.10194e-05, 3.9523e-05, 6.68037e-05, 0.000103169, 0.000147412, 0.00020055, 0.000204709, 0.000278641, 0.00049744, 0.00125247, 
                   5.9963e-05, 5.0807e-05, 4.37043e-05, 3.80669e-05, 4.67303e-05, 8.00442e-05, 0.000121959, 0.000175689, 0.000226111, 0.000238807, 0.000318635, 0.000547258, 0.00139041, 
                   6.03366e-05, 5.191e-05, 4.65917e-05, 4.30479e-05, 5.35796e-05, 9.21112e-05, 0.000141928, 0.000207873, 0.000277565, 0.000286076, 0.00040234, 0.000708473, 0.00199746};

   ////// End smearing parametrization for single muon minus:

   ////// Smearing parametrization for single muon plus:
   const float SmearingTool::meanMuPlus[104]={
                   0.00195643, 0.000948214, 0.000905174, 0.00086065, 0.000875244, 0.00081462, 0.000774613, 0.000634571, -4.53697e-06, -0.000176326, 0.00124421, 0.00215349, -0.00919238, 
                   0.00105694, 0.000214716, 0.000297863, 0.000224956, 0.000215261, -0.000160603, 0.000280179, 0.000265886, 5.57775e-05, 8.82925e-05, 6.20081e-06, -0.00186985, -0.00629617, 
                   0.000698103, -3.64237e-05, 3.98894e-05, 3.30806e-05, -1.12197e-05, -0.000154258, 5.33415e-05, -0.000297832, -0.00014583, -0.000430313, -0.000161065, -0.000973683, -0.00330624, 
                   0.000100395, -0.000143111, -0.000150323, -0.00014708, -0.000128016, -0.000245053, -8.73944e-05, -9.58366e-05, 0.000260141, -0.00010498, -3.05721e-05, -0.000248525, -0.00180429, 
                   0.000248905, -3.98542e-05, -3.2991e-05, -3.83281e-05, -4.93254e-05, -8.90898e-05, -0.000235853, -0.000276777, -0.000155249, 5.56041e-05, -0.000316633, 0.000558823, -0.00165021, 
                   0.000704896, 0.000139298, 4.20463e-05, 5.37363e-05, 3.11069e-05, 1.15929e-05, -3.34098e-05, -0.000211928, -0.0004644, -0.000221898, 7.11595e-05, 0.000779715, -0.000622626, 
                   0.00110954, 0.000355151, 0.000206598, 0.00022769, 0.000246975, 0.000149725, 0.00026059, -0.000250548, 0.000212574, -0.000362337, 0.000470112, -9.86415e-05, 0.00061569, 
                   0.00175056, 0.000933531, 0.000819287, 0.000917493, 0.000777446, 0.000733496, 0.000676177, 0.000182297, 0.000539427, 0.000631609, -0.000150681, 0.00125617, -0.000750141};
   const float SmearingTool::sig1MuPlus[104]={
                   0.0184847, 0.0196846, 0.0206004, 0.021031, 0.0218032, 0.021825, 0.0227145, 0.0232987, 0.0257655, 0.0305905, 0.0339266, 0.0399658, 0.0517304, 
                   0.017815, 0.0189144, 0.0192957, 0.0199437, 0.0206628, 0.0213739, 0.0220425, 0.023314, 0.0239887, 0.027469, 0.0291603, 0.0341381, 0.0472082, 
                   0.0148246, 0.0158597, 0.0165961, 0.0173139, 0.0181581, 0.0188373, 0.0197482, 0.019926, 0.0215426, 0.0232585, 0.026112, 0.0344415, 0.0465535, 
                   0.0111734, 0.0119384, 0.0127407, 0.0135634, 0.0144037, 0.0151744, 0.0163176, 0.0169096, 0.0173308, 0.0191093, 0.0216412, 0.0270216, 0.0422057, 
                   0.0111818, 0.0118952, 0.012739, 0.0135448, 0.0143577, 0.0151974, 0.0161001, 0.0168913, 0.0180798, 0.0194001, 0.0200485, 0.0300287, 0.043576, 
                   0.0150158, 0.0158534, 0.0164883, 0.0174059, 0.018094, 0.0188505, 0.019482, 0.0197925, 0.0214057, 0.0237671, 0.0244156, 0.0340267, 0.0487168, 
                   0.0175244, 0.0182515, 0.0190836, 0.019849, 0.0206265, 0.0212882, 0.0224351, 0.0225756, 0.022467, 0.0273537, 0.0294606, 0.0346225, 0.0479378, 
                   0.0185058, 0.0197063, 0.0203634, 0.0210222, 0.0212288, 0.0217363, 0.0233139, 0.0236304, 0.0256892, 0.0304116, 0.0338068, 0.0399921, 0.0509525};
   const float SmearingTool::sig2MuPlus[104]={
                   0.0300247, 0.031788, 0.0334883, 0.0338527, 0.0351506, 0.0330229, 0.0342935, 0.0350737, 0.0415444, 3, 3, 3, 3, 
                   0.0328499, 0.0346018, 0.0353739, 0.0354732, 0.0384435, 0.0417724, 0.0381194, 0.0518665, 0.0415053, 3, 3, 3, 3, 
                   0.027191, 0.0297515, 0.0319786, 0.0327588, 0.0333729, 0.0357833, 0.0366905, 0.0342974, 0.0473442, 0.0685487, 0.0473805, 3, 3, 
                   0.0258884, 0.0276973, 0.0292285, 0.0309816, 0.0336837, 0.0335275, 0.0370289, 0.037182, 0.0347626, 0.0370991, 0.0413248, 0.0480119, 3, 
                   0.0252879, 0.0261225, 0.0280553, 0.0300991, 0.0319167, 0.0324374, 0.0346269, 0.0360836, 0.0402189, 0.040758, 0.0332065, 0.1, 3, 
                   0.0283581, 0.0297912, 0.0306687, 0.0330451, 0.0342869, 0.0339927, 0.0330763, 0.0335676, 0.0360633, 0.0700839, 0.0378304, 3, 3, 
                   0.0305847, 0.0319893, 0.0351312, 0.0366106, 0.0380271, 0.0384603, 0.0473962, 0.0382936, 0.0349513, 3, 3, 3, 3, 
                   0.0301707, 0.0331521, 0.0331772, 0.0343367, 0.0334605, 0.0338063, 0.0358951, 0.0363778, 0.0436349, 3, 3, 3, 3};
   const float SmearingTool::Asig2MuPlus[104]={
                   0.167723, 0.169136, 0.155636, 0.179005, 0.172514, 0.344363, 0.395821, 0.4, 0.173083, 0, 0, 0, 0, 
                   0.0649015, 0.0644533, 0.0688553, 0.0782514, 0.0646565, 0.052436, 0.082697, 0.0338082, 0.0793887, 0, 0, 0, 0, 
                   0.0762432, 0.0697791, 0.0627966, 0.0677591, 0.0702146, 0.0679169, 0.0656766, 0.137382, 0.0340506, 0.0217112, 0.0632386, 0, 0, 
                   0.0329116, 0.034134, 0.0344291, 0.0331585, 0.0315179, 0.0405897, 0.0302605, 0.0375392, 0.0711568, 0.0639431, 0.0716759, 0.108231, 0, 
                   0.0340632, 0.0423355, 0.0393627, 0.0370759, 0.0371607, 0.04278, 0.0400273, 0.0446999, 0.0303197, 0.0474811, 0.232257, 0.0136698, 0, 
                   0.0723245, 0.0739842, 0.0831105, 0.06834, 0.0714325, 0.0898865, 0.133977, 0.181831, 0.115864, 0.0226714, 0.237627, 0, 0, 
                   0.091956, 0.103496, 0.0770672, 0.0725146, 0.0650365, 0.07084, 0.0418157, 0.0985768, 0.238231, 0, 0, 0, 0, 
                   0.165757, 0.141189, 0.177303, 0.182083, 0.263656, 0.333544, 0.292686, 0.357723, 0.166823, 0, 0, 0, 0};

   const float SmearingTool::ERRmeanMuPlus[104]={
                   8.56138e-05, 7.35153e-05, 6.65278e-05, 6.13732e-05, 7.68783e-05, 0.000133175, 0.000209685, 0.000295652, 0.000411314, 0.000425818, 0.000604946, 0.00111525, 0.00380412, 
                   8.32965e-05, 7.02895e-05, 6.08518e-05, 5.30122e-05, 6.52549e-05, 0.000110007, 0.000171549, 0.000242884, 0.000330416, 0.000337825, 0.000460423, 0.000799376, 0.00265506, 
                   6.75716e-05, 5.65838e-05, 4.75474e-05, 4.19459e-05, 5.38144e-05, 9.16017e-05, 0.000140613, 0.000202267, 0.000267699, 0.000285409, 0.000411492, 0.000734682, 0.002226, 
                   3.23861e-05, 2.55862e-05, 2.24199e-05, 2.16445e-05, 2.86587e-05, 4.93204e-05, 7.64969e-05, 0.000108671, 0.00014961, 0.000159657, 0.000227476, 0.000415552, 0.0012224, 
                   3.25673e-05, 2.56755e-05, 2.24989e-05, 2.17396e-05, 2.8805e-05, 4.93495e-05, 7.66095e-05, 0.000110044, 0.000149815, 0.000161344, 0.000227787, 0.00017647, 0.00128339, 
                   6.88935e-05, 5.66905e-05, 4.79649e-05, 4.23183e-05, 5.42732e-05, 9.29491e-05, 0.000143516, 0.000204843, 0.000276, 0.00028876, 0.000411836, 0.000717014, 0.00232309, 
                   8.3508e-05, 7.01804e-05, 6.13318e-05, 5.32768e-05, 6.54357e-05, 0.000111422, 0.000172637, 0.000242361, 0.000327049, 0.000342306, 0.000465259, 0.000816185, 0.00269389, 
                   8.46967e-05, 7.25981e-05, 6.60201e-05, 6.09993e-05, 7.63588e-05, 0.000131828, 0.000208494, 0.000298262, 0.000410814, 0.000419862, 0.000595838, 0.00110952, 0.00369727};
   const float SmearingTool::ERRsig1MuPlus[104]={
                   0.000247857, 0.0002397, 0.000205026, 0.000203393, 0.000268426, 0.000660189, 0.000986519, 0.000593178, 0.00202314, 0.000310762, 0.00045653, 0.000916173, 0.00375562, 
                   0.000155903, 0.000133768, 0.000121374, 0.000118711, 0.000130361, 0.000210053, 0.000451049, 0.000461031, 0.00092106, 0.000241751, 0.000332528, 0.000604839, 0.00245143, 
                   0.000123135, 0.000102017, 8.12027e-05, 7.46086e-05, 0.000104508, 0.000174372, 0.000279275, 0.000530067, 0.000436066, 0.000445948, 0.00116249, 0.000557839, 0.00203865, 
                   3.9922e-05, 3.14949e-05, 2.82713e-05, 2.71184e-05, 3.52955e-05, 6.51826e-05, 9.53845e-05, 0.000147153, 0.000251145, 0.000300682, 0.000479233, 0.00150408, 0.00104122, 
                   4.12116e-05, 3.42513e-05, 2.9372e-05, 2.79911e-05, 3.75748e-05, 6.88117e-05, 0.000106433, 0.000154374, 0.000215443, 0.000260349, 0.000668536, 0.0197627, 0.00111844, 
                   0.000122144, 0.0001019, 9.02604e-05, 7.51055e-05, 0.000101924, 0.000199231, 0.000383321, 0.000629591, 0.000716084, 0.000455744, 0.00228104, 0.000541702, 0.00221008, 
                   0.000172982, 0.000151007, 0.000123243, 0.00010776, 0.000139314, 0.000261542, 0.000327351, 0.000688981, 0.00160652, 0.000244837, 0.000336694, 0.000621067, 0.00252848, 
                   0.000248095, 0.000200146, 0.000207595, 0.000196164, 0.00030872, 0.000585925, 0.000876837, 0.00145341, 0.00174992, 0.000305983, 0.000448979, 0.000911832, 0.00365225};
   const float SmearingTool::ERRsig2MuPlus[104]={
                   0.000838549, 0.000844202, 0.000825294, 0.000740674, 0.00105656, 0.00135237, 0.00188821, 0.000795191, 0.0103655, 0, 0, 0, 0, 
                   0.00117069, 0.00109267, 0.000964946, 0.000866867, 0.00123562, 0.00265178, 0.0036063, 0.0122644, 0.00909149, 0, 0, 0, 0, 
                   0.000715312, 0.000654209, 0.000597622, 0.000530271, 0.000754416, 0.00138653, 0.00240119, 0.00235089, 0.00932989, 0.0275989, 0.0171985, 0, 0, 
                   0.000406127, 0.000317675, 0.000290214, 0.000298168, 0.000429961, 0.000671845, 0.00138552, 0.00183337, 0.00179883, 0.00257807, 0.00461844, 0.0143874, 0, 
                   0.000407534, 0.000291989, 0.000271957, 0.000280462, 0.000391525, 0.000665636, 0.00116374, 0.00164185, 0.00358147, 0.00321521, 0.00189946, 0.000434502, 0, 
                   0.000736818, 0.000626983, 0.000519657, 0.000539516, 0.000733898, 0.00121316, 0.0016623, 0.00213142, 0.00404214, 0.0286083, 0.00769522, 0, 0, 
                   0.000958362, 0.000785427, 0.000875905, 0.000858368, 0.00128588, 0.0023268, 0.00613353, 0.00484655, 0.00469788, 0, 0, 0, 0, 
                   0.000844071, 0.000842453, 0.000735975, 0.000708252, 0.000793849, 0.00124767, 0.00233805, 0.00324191, 0.00972464, 0, 0, 0, 0};
   const float SmearingTool::ERRAsig2MuPlus[104]={
                   0.0319598, 0.0305732, 0.0248385, 0.025979, 0.0334762, 0.104409, 0.28112, 0.385439, 0.276145, 0, 0, 0, 0, 
                   0.0120434, 0.0103707, 0.00945903, 0.010092, 0.00965364, 0.0136034, 0.0406158, 0.0232679, 0.080499, 0, 0, 0, 0, 
                   0.0111317, 0.00812227, 0.00581313, 0.00551375, 0.00824763, 0.0125631, 0.0207289, 0.0536697, 0.0214744, 0.0154592, 0.0870683, 0, 0, 
                   0.00216914, 0.00162172, 0.00142359, 0.00131132, 0.00155938, 0.00332299, 0.00426224, 0.00718618, 0.0165534, 0.0201843, 0.0339234, 0.124028, 0, 
                   0.00237533, 0.00209494, 0.00166431, 0.00146822, 0.00190294, 0.00380342, 0.00560256, 0.0082575, 0.00997057, 0.0143362, 0.0836222, 0.0330591, 0, 
                   0.00996527, 0.00819389, 0.00745398, 0.00554269, 0.00751661, 0.0170133, 0.0403091, 0.0698656, 0.071812, 0.0160473, 0.308768, 0, 0, 
                   0.0166781, 0.0144278, 0.00968096, 0.00830355, 0.0105131, 0.0209128, 0.0181113, 0.065765, 0.296551, 0, 0, 0, 0, 
                   0.0314722, 0.0219356, 0.0258061, 0.0241493, 0.0455245, 0.0894873, 0.126398, 0.35985, 0.266699, 0, 0, 0, 0};

   const float SmearingTool::ResRMSMuPlus[104]={
                   0.0214263, 0.0227263, 0.0236229, 0.0243125, 0.0250781, 0.026017, 0.0273444, 0.0279787, 0.0291756, 0.0303917, 0.0333925, 0.0381251, 0.0445979, 
                   0.0198804, 0.0209969, 0.0215411, 0.0222587, 0.0229589, 0.0235925, 0.0243529, 0.025293, 0.0262506, 0.0274099, 0.0290456, 0.0335811, 0.0425715, 
                   0.0168124, 0.0179817, 0.0187982, 0.019599, 0.0203741, 0.0212826, 0.0220193, 0.0231901, 0.0235581, 0.025332, 0.0281491, 0.0338425, 0.0422358, 
                   0.0127638, 0.0136977, 0.0145577, 0.0153961, 0.0163756, 0.0173379, 0.0182047, 0.0190408, 0.0201783, 0.021615, 0.0243606, 0.030035, 0.0396525, 
                   0.012696, 0.0136701, 0.014535, 0.015401, 0.0163124, 0.0172335, 0.0181481, 0.0191665, 0.0199408, 0.0218315, 0.0242359, 0.0303003, 0.04055, 
                   0.0171386, 0.0180932, 0.0189515, 0.0197394, 0.0205696, 0.0214764, 0.022501, 0.0235979, 0.0241872, 0.0258811, 0.028148, 0.0334875, 0.04338, 
                   0.0197891, 0.0208681, 0.021572, 0.0222763, 0.02287, 0.0235824, 0.0246221, 0.0251169, 0.0261616, 0.0272935, 0.0293226, 0.0339987, 0.0429886, 
                   0.0214599, 0.0227699, 0.0236954, 0.0245092, 0.0252408, 0.026245, 0.0274753, 0.0283497, 0.0295322, 0.0302323, 0.033272, 0.0381633, 0.0443582};
   const float SmearingTool::ErrResRMSMuPlus[104]={
                   6.14771e-05, 5.26765e-05, 4.75398e-05, 4.37759e-05, 5.46512e-05, 9.43188e-05, 0.000147979, 0.000208067, 0.000285734, 0.000297273, 0.000414501, 0.000717938, 0.00196713, 
                   6.01607e-05, 5.06632e-05, 4.38588e-05, 3.80647e-05, 4.68658e-05, 7.88698e-05, 0.000122122, 0.000173061, 0.000233083, 0.000237907, 0.000323048, 0.000546921, 0.00151655, 
                   4.91486e-05, 4.12216e-05, 3.46916e-05, 3.05153e-05, 3.89331e-05, 6.64387e-05, 0.000101314, 0.000145881, 0.000191968, 0.000204263, 0.000285458, 0.000501604, 0.0012936, 
                   2.42172e-05, 1.91701e-05, 1.67437e-05, 1.61038e-05, 2.13664e-05, 3.66275e-05, 5.63447e-05, 8.00018e-05, 0.000110085, 0.000115849, 0.000163314, 0.000286061, 0.000763113, 
                   2.42175e-05, 1.91304e-05, 1.67241e-05, 1.61462e-05, 2.13686e-05, 3.64215e-05, 5.63829e-05, 8.10235e-05, 0.000109233, 0.000117571, 0.000163853, 0.000290945, 0.000785346, 
                   5.02861e-05, 4.13797e-05, 3.49873e-05, 3.08034e-05, 3.94554e-05, 6.72268e-05, 0.000103339, 0.000147892, 0.000196885, 0.000206239, 0.000286926, 0.000491085, 0.00130205, 
                   6.0248e-05, 5.06871e-05, 4.43305e-05, 3.84043e-05, 4.69221e-05, 7.96931e-05, 0.000123556, 0.000171945, 0.000230483, 0.000241073, 0.000326048, 0.000556534, 0.0015314, 
                   6.07609e-05, 5.2178e-05, 4.73013e-05, 4.35799e-05, 5.44313e-05, 9.3482e-05, 0.000146786, 0.000209418, 0.000286034, 0.000293393, 0.000408438, 0.000714614, 0.00198376};

   ////// End smearing parametrization for single muon plus:

SmearingTool::SmearingTool(){
}
float SmearingTool::PTsmear(float PTmuonGen, float ETAmuonGen, float CHARGEmuonGen, float PTmuonReco, int Ismear, TString ParVar,float ParSig){
   //Ismear = 1 - Smear with RND (no RECO use), Ismear = 2 - Smear with SF for RECO and GEN
   if(Ismear != 1 && Ismear != 2)std::cout << "ERROR SmearingTool::PTsmear: set Ismear to 1 or 2 for smearing" << std::endl;
   const int NPThist = (sizeof(PTbin)/sizeof(float)-1);
   const int NETAhist = (sizeof(ETAbin)/sizeof(float)-1);
   //const int Nhist = NPThist*NETAhist;
   ////// Make smearing for single muon from Gen level PostFSR:
   float PTmuonSmear = -10.;
   float meanVar = 0;
   float sigVar = 0;//for sig1 and sig2
   float Asig2Var = 0;
   if(ParVar == "mean")meanVar = ParSig;
   if(ParVar == "sig1" || ParVar == "sig2")sigVar = ParSig;
   if(ParVar == "Asig2Var")Asig2Var = ParSig;
   int iK_cand = -1;
   for(int iPT = 0; iPT < NPThist; iPT++){
   for(int iETA = 0; iETA < NETAhist; iETA++){
      int iK = iPT + iETA*NPThist;
      // smear muons which out of range PT and ETA
      float PTcutDown = PTbin[iPT];
      float PTcutUp = PTbin[iPT+1];
      if(iPT == 0 && PTmuonGen < PTbin[0])PTcutDown = PTmuonGen-0.001;
      if(iPT == (NPThist-1) && PTmuonGen > PTbin[NPThist])PTcutUp = PTmuonGen+0.001;
      float ETAcutDown = ETAbin[iETA];
      float ETAcutUp = ETAbin[iETA+1];
      if(iETA == 0 && ETAmuonGen < ETAbin[0])ETAcutDown = ETAmuonGen-0.001;
      if(iETA == (NETAhist-1) && ETAmuonGen >= ETAbin[NETAhist])ETAcutUp = ETAmuonGen+0.001;
      if(PTmuonGen >= PTcutDown && PTmuonGen < PTcutUp
      && ETAmuonGen >= ETAcutDown && ETAmuonGen < ETAcutUp) iK_cand = iK;
   }}

   ///// Set Scale Factor
   float ScaleFactor = 1.;
   if (fabs(ETAmuonGen) < 0.8) ScaleFactor = 0.92;
   if (fabs(ETAmuonGen) >= 0.8 && fabs(ETAmuonGen) < 1.2) ScaleFactor = 0.99;
   if (fabs(ETAmuonGen) >= 1.2) ScaleFactor = 1.045;
   TF1* fitDoubleGauss = new TF1("fitDoubleGauss", DoubleGauss, -0.1, 0.1, 5);
   fitDoubleGauss->SetParameter(4,1.);
   if(iK_cand > -1 && Ismear == 1 && CHARGEmuonGen < 0){
      float meanCorr = mean[iK_cand] + meanVar*ERRmean[iK_cand];
      float sig1Corr = sig1[iK_cand] + sigVar*ERRsig1[iK_cand];
      if(sig1Corr < 0.005) sig1Corr = 0.005;
      float sig2Corr = sig2[iK_cand] + sigVar*ERRsig2[iK_cand];
      if(sig2Corr < 0.005) sig2Corr = 0.005;
      float Asig2Corr = Asig2[iK_cand] + Asig2Var*ERRAsig2[iK_cand];
      if(Asig2Corr < 0.) Asig2Corr = 0.;
      fitDoubleGauss->SetParameter(0,meanCorr);
      fitDoubleGauss->SetParameter(1,ScaleFactor*sig1Corr);
      fitDoubleGauss->SetParameter(2,Asig2Corr);
      fitDoubleGauss->SetParameter(3,ScaleFactor*sig2Corr);
      Double_t resSim = fitDoubleGauss->GetRandom();
      PTmuonSmear = PTmuonGen*(1+resSim);
   }
   if(iK_cand > -1 && Ismear == 1 && CHARGEmuonGen > 0){
      float meanCorr = meanMuPlus[iK_cand] + meanVar*ERRmeanMuPlus[iK_cand];
      float sig1Corr = sig1MuPlus[iK_cand] + sigVar*ERRsig1MuPlus[iK_cand];
      if(sig1Corr < 0.005) sig1Corr = 0.005;
      float sig2Corr = sig2MuPlus[iK_cand] + sigVar*ERRsig2MuPlus[iK_cand];
      if(sig2Corr < 0.005) sig2Corr = 0.005;
      float Asig2Corr = Asig2MuPlus[iK_cand] + Asig2Var*ERRAsig2MuPlus[iK_cand];
      if(Asig2Corr < 0.) Asig2Corr = 0.;
      fitDoubleGauss->SetParameter(0,meanCorr);
      fitDoubleGauss->SetParameter(1,ScaleFactor*sig1Corr);
      fitDoubleGauss->SetParameter(2,Asig2Corr);
      fitDoubleGauss->SetParameter(3,ScaleFactor*sig2Corr);
      Double_t resSim = fitDoubleGauss->GetRandom();
      PTmuonSmear = PTmuonGen*(1+resSim);
   }
   delete fitDoubleGauss;
   if(iK_cand > -1 && Ismear == 2){
      PTmuonSmear = PTmuonGen + ScaleFactor*(PTmuonReco - PTmuonGen);
   }
   ////// End Smearing parametrization for single muon:

   return PTmuonSmear;
 }//end PTsmear function

   Double_t DoubleGauss(Double_t *x, Double_t *par)
   {
       double dgauss = 0.;
        if(par[1] < par[3]){//not normalized gauss both gauss are  = 1 at x[0]=par[0]
                  dgauss =  exp(-0.5*(x[0]-par[0])*(x[0]-par[0])/par[1]/par[1]);
                  dgauss = dgauss + par[2]*exp(-0.5*(x[0]-par[0])*(x[0]-par[0])/par[3]/par[3]);
                  dgauss = par[4]*dgauss;
        }
       return dgauss;
   }
